---
title: "Custom PostCSS Config"
---

Provide your own `postcss.config.js` to override Baseline’s fallback. Keep cssnano for production only, add or remove plugins as needed, and verify the output.

## Prerequisites
- Baseline installed and loaded; assets pipeline enabled.
- `src/assets/css/index.css` exists as the entry.
- `package.json` with `"type": "module"` and scripts (`dev`, `build`).
- Install PostCSS and the plugins you plan to use when overriding the default config:
  ```bash
  npm install postcss postcss-import postcss-preset-env cssnano
  ```
  Baseline ships fallback plugins, but when you provide your own `postcss.config.js`, bring the plugins as explicit dependencies.

## Steps

<div class="c-docs-steps">

1. Add `postcss.config.js` at the project root:

   ```js
   const isProd = process.env.ELEVENTY_ENV === "production";

   module.exports = {
     map: isProd ? false : { inline: false },
     plugins: {
       "postcss-import": {},
       "postcss-preset-env": { stage: 1 },
       ...(isProd ? { cssnano: { preset: "default" } } : {})
     }
   };
   ```

2. Use imports to split CSS into partials:

   ```css
   /* src/assets/css/base.css */
   body {
     margin: 0;
     font-family: system-ui, sans-serif;
     color: #0f172a;
     background: #f8fafc;
   }

   /* src/assets/css/links.css */
   .nav-links {
     display: inline-flex;
     gap: 0.75rem;
     padding: 0.5rem 0;
   }

   .nav-links a {
     color: #0f172a;
     text-decoration: underline;
     text-decoration-color: #0ea5e9;
     text-decoration-thickness: 2px;
     text-underline-offset: 3px;
     font-weight: 600;
   }

   .nav-links a:hover {
     color: #0ea5e9;
   }

   /* src/assets/css/index.css */
   @import "./base.css";
   @import "./links.css";
   ```

3. Add a plugin Baseline doesn’t ship, e.g. `postcss-custom-media`:

   ```bash
   npm install postcss-custom-media
   ```

   Update `postcss.config.js`:
   ```js
   const isProd = process.env.ELEVENTY_ENV === "production";

   module.exports = {
     map: isProd ? false : { inline: false },
     plugins: {
       "postcss-import": {},
       "postcss-custom-media": {},
       "postcss-preset-env": { stage: 1 },
       ...(isProd ? { cssnano: { preset: "default" } } : {})
     }
   };
   ```

4. Exercise the config in your CSS (add a narrow breakpoint in links):

   Keep `src/assets/css/index.css` simple and rely on the imported partials:
   ```css
   /* media override in links.css */
   @custom-media --narrow (max-width: 768px);
   @media (--narrow) {
     .nav-links {
       display: grid;
       gap: 0.5rem;
     }
     .nav-links a {
       text-decoration-color: #fc35b9;
     }
     .nav-links a:hover {
       color: #fc35b9;
     }
   }
   ```

5. Run and inspect
   - Dev: `npx rimraf dist && npm run dev`
   - Build: `npx rimraf dist && npm run build`
   - Check `dist/assets/css/index.css`:
     - Dev: expanded CSS with mapped imports; no minification.
     - Prod: minified (cssnano), imports flattened, custom media resolved.

</div>

## Notes
- Your `postcss.config.js` fully overrides Baseline’s fallback. Keep the entry file at `src/assets/css/index.css`; add partials via imports.
- Add/remove plugins as needed (e.g., purge/RTL/lightningcss). Use env guards to keep dev output readable and prod output optimized.

